// build target for compiling against unity trunk
//
// this includes debugging utilities and some third party code that should not be
// distributed. do not ship builds from trunk!
{
	"Name":"ProBuilder Unity Trunk",
	"UnityPath":[
		"C:/Users/$USER/unity/unity/build/WindowsEditor",
		"/Users/$USER/unity/unity/build/MacEditor/Unity.app",
		// i keep trunk checked out in ~/unity/unity, but most people probably just have trunk ~/unity
		"C:/Users/$USER/unity/build/WindowsEditor",
		"/Users/$USER/unity/build/MacEditor/Unity.app",
	],
	"Macros": {
		"$SRC_PROJECT_ROOT": "probuilder2.0/Assets",
		"$DST_PROJECT_ROOT": "bin/projects/ProBuilder-trunk/Assets",
		"$SRC_PB_ROOT": "probuilder2.0/Assets/ProCore/ProBuilder",
		"$BUILD_DIR": "bin/projects",
		"$DST_PB_ROOT": "bin/projects/ProBuilder-trunk/Assets/ProBuilder",
		"$DST_PB_NAME": "ProBuilder",
		"$UNITY_VERSION": "trunk",
	},
	"Defines": [
		"PROBUILDER_DLL",
		"UNITY_5_OR_NEWER",
		"UNITY_5_3_OR_NEWER"
		"UNITY_5_5_OR_NEWER",
		"UNITY_5_6_OR_NEWER",
		"UNITY_2017_1_OR_NEWER",
		"UNITY_2017_2_OR_NEWER",
		"UNITY_2017_3_OR_NEWER",
		"UNITY_2018_1_OR_NEWER",
		"UNITY_2018_1",
	],
	"Clean":[
		{ "Command":"rm", "Arguments": [ "$BUILD_DIR/$DST_PB_NAME-$UNITY_VERSION" ] },
	],
	"OnPreBuild":[
		{ "Command":"mkdir", "Arguments": [ "$BUILD_DIR/$DST_PB_NAME-$UNITY_VERSION/Assets" ] },
		{ "Command":"cp", "Arguments": [ "$SRC_PB_ROOT", "$DST_PB_ROOT" ] },
		// rm doesn't accept wildcards at the moment, so delete the folder and recreate it since
		// it's going to be compiled to DLL and put back
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/AssetIdRemapUtility/Editor" ] },
		{ "Command":"mkdir", "Arguments": [ "$DST_PB_ROOT/AssetIdRemapUtility/Editor" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Classes/ClassesCore" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Classes/ClassesEditing" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Editor/EditorCore" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Classes/ClassesCore.meta" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Classes/ClassesEditing.meta" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Editor/EditorCore.meta" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Data" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/Data.meta" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/API Examples" ] },
		{ "Command":"rm", "Arguments": [ "$DST_PB_ROOT/API Examples.meta" ] },
		{ "Command":"cp", "Arguments": [ "build/targets/resources/$UNITY_VERSION/ProBuilderCore.dll.meta", "$DST_PB_ROOT/Classes/ProBuilderCore.dll.meta" ] },
		{ "Command":"cp", "Arguments": [ "build/targets/resources/$UNITY_VERSION/ProBuilderMeshOps.dll.meta", "$DST_PB_ROOT/Classes/ProBuilderMeshOps.dll.meta" ] },
		{ "Command":"cp", "Arguments": [ "build/targets/resources/$UNITY_VERSION/ProBuilderEditor.dll.meta", "$DST_PB_ROOT/Editor/ProBuilderEditor.dll.meta" ] },
//		{ "Command":"cp", "Arguments": [ "$SRC_PROJECT_ROOT/Debug", "$DST_PROJECT_ROOT/Debug" ] },
//		{ "Command":"cp", "Arguments": [ "$SRC_PROJECT_ROOT/ConsolePro", "$DST_PROJECT_ROOT/ConsolePro" ] },
	],
	"ReferenceSearchPaths":[
		"$UNITY/Data/Mono/lib/mono/2.0",
		"$UNITY/Data/Managed"
	],
	"Assemblies":
	[
		{
			"SourceDirectory": "$SRC_PB_ROOT/Classes/ClassesCore",
			"OutputAssembly": "$DST_PB_ROOT/Classes/ProBuilderCore.dll",
		},
		{
			"SourceDirectory": "$SRC_PB_ROOT/Classes/ClassesEditing",
			"OutputAssembly": "$DST_PB_ROOT/Classes/ProBuilderMeshOps.dll",
			"ReferencedAssemblies": [
				"$DST_PB_ROOT/Classes/ProBuilderCore.dll",
				"$SRC_PB_ROOT/Classes/ClassesLib/pb_Stl.dll",
				"$SRC_PB_ROOT/Classes/ClassesLib/Poly2Tri.dll",
				"$SRC_PB_ROOT/Classes/ClassesLib/KdTreeLib.dll"
			]
		},
		{
			"SourceDirectory": "$SRC_PB_ROOT/Editor/EditorCore",
			"OutputAssembly": "$DST_PB_ROOT/Editor/ProBuilderEditor.dll",
			"Defines": [
				"UNITY_EDITOR"
			],
			"ReferencedAssemblies": [
				"UnityEditor.dll",
				"$DST_PB_ROOT/Classes/ProBuilderCore.dll",
				"$DST_PB_ROOT/Classes/ProBuilderMeshOps.dll",
				"$SRC_PB_ROOT/Classes/ClassesLib/pb_Stl.dll",
				"$SRC_PB_ROOT/Classes/ClassesLib/Poly2Tri.dll",
				"$SRC_PB_ROOT/Classes/ClassesLib/KdTreeLib.dll"
			]
		},
		{
			"SourceDirectory": "$SRC_PB_ROOT/AssetIdRemapUtility/Editor",
			"OutputAssembly": "$DST_PB_ROOT/AssetIdRemapUtility/Editor/AssetIdRemapUtility.dll",
			"Defines": [
				"UNITY_EDITOR"
			],
			"ReferencedAssemblies": [
				"UnityEditor.dll"
			]
		}
	]
}
